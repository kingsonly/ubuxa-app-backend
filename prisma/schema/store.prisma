model Store {
  id          String  @id @default(auto()) @map("_id") @db.ObjectId
  name        String
  description String?
  address     String?
  phone       String?
  email       String?
  type        StoreType @default(BRANCH)
  isActive    Boolean   @default(true)

  // Tenant relationship
  tenantId String @db.ObjectId
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  // User assignments through UserTenant relationship
  assignedUserTenants UserTenant[] @relation("UserTenantStore")

  // Inventory batch allocations
  batchAllocations StoreBatchAllocation[]

  // Sales
  sales Sales[]

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  @@unique([tenantId, name])
  @@map("stores")
}

model StoreBatchAllocation {
  id String @id @default(auto()) @map("_id") @db.ObjectId

  batchId String         @db.ObjectId
  batch   InventoryBatch @relation(fields: [batchId], references: [id], onDelete: Cascade)

  storeId String @db.ObjectId
  store   Store  @relation(fields: [storeId], references: [id], onDelete: Cascade)

  allocatedQuantity Int
  remainingQuantity Int

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([batchId, storeId])
  @@map("store_batch_allocations")
}

enum StoreType {
  MAIN
  BRANCH
  LEAFLET
}
